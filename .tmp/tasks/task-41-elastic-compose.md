# 41: 検索のElastic対応（docker-composeの用意）

- [ ] 検索用の Elasticsearch サービスを `docker-compose` に追加する

## 目的

NodeBB プラグイン群から利用する検索バックエンドとして Elasticsearch を別コンテナで提供する。アプリ本体およびプラグインの実装には触れず、まずは構成と責務を明確化する。

## 要件

- バージョンは LTS 互換の安定版（例: 8.x 系）を明示
- 開発用途（シングルノード、セキュリティ最小構成）
- ホストマシンへのポート公開は必要最小限（HTTP のみ）
- データはボリュームに永続化
- 禁止コマンド（停止/再起動系）は使わない運用前提

## サービス責務

- インデックスの作成・マッピング適用
- ドキュメントの登録・更新・削除
- クエリの実行（言語別トークナイズ、ハイライトを含む）
- ヘルスチェック（NodeBB 側からの疎通確認）

## コンテナ構成（設計方針）

- サービス名: `elasticsearch`
- ポート: `9200` のみ公開（HTTP）。`9300`（transport）はローカルのみ
- 環境変数: 開発用の最小セット（`discovery.type=single-node` など）
- ボリューム: `esdata:/usr/share/elasticsearch/data`

docker-compose.yml（本番用）と docker-compose.dev.yml（開発用）にサービスを定義する。本番用設定、開発時の設定で違いがあれば、それを各設定ファイルに反映する。

## 注意事項

- このリポジトリでは、Docker 停止/再起動系コマンドは「厳禁」
- 検索機能の多言語対応は別チェックボックスで扱う（本タスクはコンテナ構成のみ）

